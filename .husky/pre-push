#!/bin/bash
set -e

echo "ğŸ” Iniciando verificaÃ§Ãµes de prÃ©-push na brazil-formatter..."

CHANGED_TS_FILES=$(git diff --name-only origin/main | grep -E '\.(ts)$' || true)

if [ -n "$CHANGED_TS_FILES" ]; then
  echo "ğŸš¨ MudanÃ§as em TypeScript detectadas â€” validando..."
  
  npm run type-check
  
  echo "ğŸ§ª Rodando suÃ­te de testes..."
  npm test
  
  # 3. Linting (Assim que vocÃª configurar o ESLint)
  # echo "ğŸ’… Verificando estilo de cÃ³digo..."
  # npm run lint

else
  echo "âœ… Nenhuma mudanÃ§a crÃ­tica em arquivos .ts."
fi

echo "ğŸš€ Pronto para o push!"
exit 0